# WIP

**SHA256 aff2e319a47193ab195e2aa116747c2a5aa4bb4d8cc4c915e0c6bda12481881f** (confirmed on machine)

### Steps taken:
## Target Acquisition
- I had to enable the network adapter on the FlareVM to download the sample, because it was automatically removed from my host, despite being zipped and locked with a password.
- I downloaded the sample and removed the network adapter again.
- I ran Get-FileHash on the file after unzipping it.
- File name is same as hash with .exe as the file extension. Unlikely to be the original file name.
- File is from 4 days ago (2025-04-18)
- Virustotal detection ratio (59/72)
- Virustotal detects it as akira.exe
- Virustotal Creation time 2025-03-19
- Virustotal First submission 2025-04-11
- Virustotal finds a lot of other useful information but I want to practice finding it myself first.

## Static Recon
- Running strings gave me a whole lot of nonsense at first. Then I tuned it to a minimum length of 6 characters, yielding better results.
- While it's possible some commands are shorter than 6 characters long, it was too many lines to read through in a single week on the off chance that it contains something valuable.
- Halfway down the file I started seeing real words and commands.
- I located the command for deleting the shadow copy.
>powershell.exe -Command "Get-WmiObject Win32_Shadowcopy | Remove-WmiObject"
- I found references to various DLL files.
- I found a lot of error messages.
- Found akira_readme.txt ransom note
>Whatever who you are and what your title is if you're reading this it means the internal infrastructure of your company is fully or partially dead, all your backups - virtual, physical - everything that we managed to reach - are completely removed. Moreover, we have taken a great amount of your corporate data prior to encryption.
>Well, for now let's keep all the tears and resentment to ourselves and try to build a constructive dialogue. We're fully aware of what damage we caused by locking your internal sources. At the moment, you have to know:
>1. Dealing with us you will save A LOT due to we are not interested in ruining your financially. We will study in depth your finance, bank & income statements, your savings, investments etc. and present our reasonable demand to you. If you have an active cyber insurance, let us know and we will guide you how to properly use it. Also, dragging out the negotiation process will lead to failing of a deal.
>2. Paying us you save your TIME, MONEY, EFFORTS and be back on track within 24 hours approximately. Our decryptor works properly on any files or systems, so you will be able to check it by requesting a test decryption service from the beginning of our conversation. If you decide to recover on your own, keep in mind that you can permanently lose access to some files or accidently corrupt them - in this case we won't be able to help.
>3. The security report or the exclusive first-hand information that you will receive upon reaching an agreement is of a great value, since NO full audit of your network will show you the vulnerabilities that we've managed to detect and used in order to get into, identify backup solutions and upload your data.
>4. As for your data, if we fail to agree, we will try to sell personal information/trade secrets/databases/source codes - generally speaking, everything that has a value on the darkmarket - to multiple threat actors at ones. Then all of this will be published in our blog - REDACTED
>5. We're more than negotiable and will definitely find the way to settle this quickly and reach an agreement which will satisfy both of us.
>If you're indeed interested in our assistance and the services we provide you can reach out to us following simple instructions:
>1 Install TOR Browser to get access to our chat room - https://www.torproject.org/download/.
>2 Paste this link - REDACTED
>Use this code - REDACTED - to log into our chat.
>Keep in mind that the faster you will get in touch, the less damage we cause. 

- Found commands targeting the recycle bin.
- Found a command for deleting Windows event logs.
>Get-WinEvent -ListLog * | where { $_.RecordCount } | ForEach-Object -Process{ [System.Diagnostics.Eventing.Reader.EventLogSession]::GlobalSession.ClearLog($_.LogName) }

List of hardcoded extensions found at the end of the file:
- .accde
- .accdc
- accdb
- .accft
- .accdt
- .accdr
- .dacpac
- .db-scm
- .daschema
- .dadiagrams
- .db-wal
- .fmps1
- .fmp12
- .kexic
- .kexis
- .nrmlib
- .sas7bdat
- .sqlitedb
- .sqlite3
- .sqlite
- .abcddb
- .xmlff
- .accdw
- .nvram
- .subvol
- .qcow2
- And many more.
- At the very end, after a bit more text there is a reference to the file type .arika, (akira backwards). Could possibly be a kill switch or similar. Could also be a lazy file extension change to throw off defenders.

- No registry keys
- No hardcoded file path
- Unable to confirm existence of mutex in file based on strings result

## PE header analysis:
##### Starting with CFF explorer.
- Address of entry point is 0008DD38, which is .text.
- The import libs contain the following:
	- KERNEL32.dll
	- SHELL32.dll
	- OLEAUT32.dll
	- WS2_32.dll
	- SHLWAPI.dll
- KERNEL.dll being the most used used for the majority of functions.
#### Moving on to PEStudio
- The imports here are more granular, with clear calls to for example DeleteFileW, and WriteFile.
- No signs of packing.

### Dynamic analysis
- Based on 3 different ANY.RUN detonations it doesn't look like much happens. In only one of them did the ransom note get delivered. 
- No consistent network calls were made, which makes some sense since that's not how Akira works.
- It does spawn a PowerShell instance and attempts to delete shadow volumes.
- It makes some rundll calls as well but nothing comes of it. No files are ever encrypted in the ANY.RUN samples which have the same hash as my file, running on Windows 10.

### Intelligence synthesis

Sample hash: SHA256 aff2e319a47193ab195e2aa116747c2a5aa4bb4d8cc4c915e0c6bda12481881f
Behavioral summary: _This malware sample is the Akira ransomware based on C++ which deletes backups and leaves a ransom note requiring the victim to chat with the threat actor to negotiate a ransom payment._
Static findings:
- Ransom note contents
- Windows PowerShell commands for repudiation and denial of restoration
- Target file extensions
Dynamic behavior: Fizzles out on itself due to defense evasion techniques, confirmed in ANY.RUN.
